!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash"),require("angular")):"function"==typeof define&&define.amd?define(["lodash","angular"],t):"object"==typeof exports?exports["builder.min"]=t(require("lodash"),require("angular")):e["builder.min"]=t(e.lodash,e.angular)}(window,function(e,t){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=5)}([function(t,r){t.exports=e},function(e,t,r){e.exports=r(4).ObjectPath},function(e,r){e.exports=t},function(e,t,r){"use strict";r.r(t);var a=r(2),i=r.n(a);function n(e,t){e.addPostProcess(function(e){for(var r=function(e,t){return!(void 0===e)},a=function(e,t){return!(null===e)},i=function(e){return""===e?null:e},n=0;n<e.length;n++)t.traverseForm(e[n],function(e){if(e.schema){var t={};e.schema.requiredAllowNull&&(t.requiredAllowNull=r),e.schema.failNull&&(t.failNull=a),e.$validators=_.merge({},e.$validators,t);var n=[];-1!=e.schema.type.indexOf("string")&&e.schema.nullable&&n.push(i),e.$parsers=void 0===e.$parsers?n:e.$parsers.concat(n)}});return e})}function s(e){e.setDefaultMessage("requiredAllowNull","Required"),e.setDefaultMessage("failNull","Required")}n.$inject=["postProcess","schemaForm"],s.$inject=["sfErrorMessageProvider"];var l=r(0),o=r.n(l),c=r(1),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.a.module("beer-garden.builder",[]).run(n).config(s).factory("SFBuilderService",function(){var e={build:function(t,r){var a=e.buildModelSF(r,["parameters"]),i=void 0,n=void 0;if(i=void 0===r.schema||o.a.isEqual({},r.schema)?{type:"object",properties:a.schema}:{type:"object",properties:r.schema},void 0===r.form||o.a.isEqual({},r.form)||o.a.isEqual([],r.form)){n=[];var s=[],l=[],u=!0,m=!1,d=void 0;try{for(var p,f=a.form[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var h=p.value,y="string"==typeof h?h:h.key;y="string"==typeof y?Object(c.parse)(y):y,i.properties[y[y.length-1]].optional?l.push(h):s.push(h)}}catch(e){m=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(m)throw d}}l.length?(s.length||s.push({type:"help",helpvalue:'<div uib-alert class="alert alert-info m-b-0">None! :)</div>'}),n.push({type:"tabs",tabs:[{title:"Required Fields",items:s},{title:"Optional Fields",items:l}]})):n=s}else n=Array.isArray(r.form)?r.form:[r.form];var b=e.buildCommonSF(t,r);return b.schema.parameters=i,{schema:{type:"object",properties:b.schema},form:n.concat(b.form)}},buildCommonSF:function(e,t){var r=[],a=!0,i=!1,n=void 0;try{for(var s,l=e.instances[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var o=s.value;r.push(o.name)}}catch(e){i=!0,n=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw n}}var c={system:{title:"System Name",type:"string",default:e.name,required:!0},system_version:{title:"System Version",type:"string",default:e.version,required:!0},command:{title:"Command Name",type:"string",default:t.name,required:!0},comment:{title:"Comment",type:"string",default:"",required:!1,maxLength:140,validationMessage:"Maximum comment length is 140 characters"},output_type:{title:"Output Type",type:"string",default:t.output_type,required:!1},instance_name:{title:"Instance Name",type:"string",required:!0}};return 1==e.instances.length&&(c.instance_name.default=r[0],c.instance_name.readonly=!0),{schema:c,form:{type:"fieldset",items:[{type:"help",helpvalue:"<hr>"},{type:"section",htmlClass:"row",items:[{key:"system",feedback:!1,disableSuccessState:!0,disableErrorState:!0,readonly:!0,required:!0,htmlClass:"col-md-3"},{key:"system_version",feedback:!1,disableSuccessState:!0,disableErrorState:!0,readonly:!0,required:!0,htmlClass:"col-md-3"},{key:"command",feedback:!1,disableSuccessState:!0,disableErrorState:!0,readonly:!0,required:!0,htmlClass:"col-md-3"},{key:"instance_name",feedback:!1,disableSuccessState:!0,htmlClass:"col-md-3",type:"select",choices:{titleMap:r}}]},{key:"comment",type:"textarea",feedback:!0,disableSuccessState:!1,disableErrorState:!1,readonly:!1,required:!1,fieldHtmlClass:"m-b-3"},{type:"help",helpvalue:'<div uib-alert class="alert alert-warning m-b-0">Instance is not RUNNING, but you can still "Make Request"</div><br>',condition:"checkInstance(instance_name)"},{type:"section",htmlClass:"row",items:[{type:"button",style:"btn-warning w-100 ",title:"Reset",onClick:"reset(ngform, model, system, command.data)",htmlClass:"col-md-2"},{type:"submit",style:"btn-primary w-100",title:"Make Request",htmlClass:"col-md-10"}]}]}}},buildModelSF:function(t,r){for(var a={},i=[],n=0,s=t.parameters.length;n<s;n++){var l=t.parameters[n],o=l.key,c=e.buildParameterSF(l,r);a[o]=c.schema,i.push(c.form)}return{schema:a,form:i}},buildParameterSF:function(t,r,a){var i={schema:{title:t.display_name,optional:t.optional,nullable:t.nullable,description:o.a.escape(t.description)},form:{key:r.concat(t.key)}};a&&i.form.key.push("");var n=void 0;return n=t.multi&&!a?e.buildMultiParameterSF:t.parameters&&t.parameters.length>0?e.buildModelParameterSF:e.buildSimpleParameterSF,o.a.merge({},i,n(t,r,a))},buildSimpleParameterSF:function(e,i,n){var s=t(e.type),l=s.schema,c=s.form;if(a(c,"type",e.form_input_type),-1===l.type.indexOf("boolean")&&(e.optional||(l[e.nullable?"requiredAllowNull":"required"]=!0),e.nullable||(l.failNull=!0)),!n){var m=r(e,l.type);void 0!==m&&(null!==m||e.nullable)&&(l.default=m),-1!==l.type.indexOf("string")?(a(l,"maxLength",e.maximum),a(l,"minLength",e.minimum),a(l,"pattern",e.regex)):-1===l.type.indexOf("integer")&&-1===l.type.indexOf("number")||(a(l,"maximum",e.maximum),a(l,"minimum",e.minimum))}if(e.choices&&!o.a.isEqual(e.choices,{})){if(e.choices.display?"typeahead"===e.choices.display?c.type="typeahead":"select"===e.choices.display?c.type="select":(c.type="typeahead",console.error("Don't know how to render choices type '"+e.choices.type+"', defaulting to 'typeahead' (valid options are 'typeahead' and 'select')")):c.type="typeahead",e.choices.strict&&(c.strict=!0),"static"===e.choices.type){if(c.choices={titleMap:e.choices.value},e.choices.details&&e.choices.details.key_reference){var d=i+"."+e.choices.details.key_reference;c.choices.updateOn=d,c.choices.transforms=[{lookupField:d}]}}else if("url"===e.choices.type){c.choices={updateOn:[],httpGet:{url:e.choices.details.address,queryParameterFields:{}}};for(var p=0;p<e.choices.details.args.length;p++){var f=e.choices.details.args[p],h=i+"."+f[1];c.choices.updateOn.push(h),c.choices.httpGet.queryParameterFields[f[0]]=h}}else if("command"===e.choices.type){c.choices={updateOn:[],callback:{function:"createRequestWrapper",arguments:[{command:e.choices.details.name,parameterNames:[]}],argumentFields:[]}};for(var y=0;y<e.choices.details.args.length;y++){var b=e.choices.details.args[y],g=i+"."+b[1];c.choices.updateOn.push(g),c.choices.callback.argumentFields.push(g),c.choices.callback.arguments[0].parameterNames.push(b[0])}"object"===u(e.choices.value)&&Object.assign(c.choices.callback.arguments[0],{system:e.choices.value.system,system_version:e.choices.value.system_version,instance_name:e.choices.value.instance_name})}else console.error("Don't know how to handle parameter '%s' choices type (%s)",e.key,e.choices.type);e.nullable&&"select"===c.type&&(Array.isArray(c.choices.transforms)||(c.choices.transforms=[]),c.choices.transforms.push("fixNull"))}return{schema:l,form:c}},buildMultiParameterSF:function(t,i){var n=e.buildParameterSF(t,i,!0);delete n.schema.default,n.form.notitle=!0,n.form.htmlClass="clear-right",delete n.schema.description,"object"===n.schema.type&&(n.schema.nullable=!1);var s={schema:{type:["array","null"],items:n.schema},form:{startEmpty:!!t.nullable,items:[n.form]}},l=r(t,"array");return void 0!==l&&(s.schema.default=l,s.form.startEmpty=!0),a(s.schema,"maxItems",t.maximum),a(s.schema,"minItems",t.minimum),s},buildModelParameterSF:function(t,a,i){var n=i?a.concat(t.key,""):a.concat(t.key),s=e.buildModelSF(t,n),l=r(t,"object"),c={},u={type:"object",partition:"!optional",accordionHeading:"Optional Fields",properties:s.schema};return t.optional&&t.nullable&&o.a.isEqual({},l)&&!i?u.format="nullable":(u.default=l,c.items=s.form),{schema:u,form:c}}},t=function(e){var t=e.toLowerCase(),r={type:[{any:"variant",integer:"integer",float:"number",boolean:"boolean",dictionary:"dictionary",string:"string",date:"integer",datetime:"integer"}[t]||"string","null"]},a={};return"date"===t?(r.format="datetime",a.options={format:"MM/DD/YYYY"}):"datetime"===t&&(r.format="datetime"),{schema:r,form:a}},r=function(e,t){switch(t){case"boolean":return e.nullable&&null===e.default?null:!!e.default;case"array":return e.default?o.a.merge([],e.default):null===e.default&&e.nullable?null:void 0;case"object":return e.default?o.a.merge({},e.default):{};default:return e.default}},a=function(e,t,r){o.a.isUndefined(r)||null===r||(e[t]=r)};return e});t.default="beer-garden.builder"},function(e,t,r){"use strict";var a,i;i={parse:function(e){if("string"!=typeof e)throw new TypeError("ObjectPath.parse must be passed a string");for(var t,r,a,i,n=0,s=[];n<e.length;)if(t=e.indexOf(".",n),r=e.indexOf("[",n),-1===t&&-1===r)s.push(e.slice(n,e.length)),n=e.length;else if(-1===r||-1!==t&&t<r)s.push(e.slice(n,t)),n=t+1;else if(r>n&&(s.push(e.slice(n,r)),n=r),'"'!==(a=e.slice(r+1,r+2))&&"'"!==a)-1===(i=e.indexOf("]",r))&&(i=e.length),s.push(e.slice(n+1,i)),n="."===e.slice(i+1,i+2)?i+2:i+1;else{for(-1===(i=e.indexOf(a+"]",r))&&(i=e.length);"\\"===e.slice(i-1,i)&&r<e.length;)r++,i=e.indexOf(a+"]",r);s.push(e.slice(n+2,i).replace(new RegExp("\\"+a,"g"),a)),n="."===e.slice(i+2,i+3)?i+3:i+2}return s},stringify:function(e,t){return Array.isArray(e)||(e=[e.toString()]),t='"'===t?'"':"'",e.map(function(e){return"["+t+e.toString().replace(new RegExp(t,"g"),"\\"+t)+t+"]"}).join("")},normalize:function(e,t){return i.stringify(Array.isArray(e)?e:i.parse(e),t)},registerModule:function(e){e.module("ObjectPath",[]).provider("ObjectPath",function(){this.parse=i.parse,this.stringify=i.stringify,this.normalize=i.normalize,this.$get=function(){return i}})}},void 0===(a=function(){return{ObjectPath:i}}.call(t,r,t,e))||(e.exports=a)},function(e,t,r){e.exports=r(3)}])});